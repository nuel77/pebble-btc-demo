<!--
=========================================================
 Paper Dashboard 2 - v2.0.0
=========================================================

 Product Page: https://www.creative-tim.com/product/paper-dashboard-2
 Copyright 2019 Creative Tim (https://www.creative-tim.com)
 Licensed under MIT (https://github.com/creativetimofficial/paper-dashboard/blob/master/LICENSE)

 Coded by Creative Tim

=========================================================

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->


<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <link href="assets/img/apple-icon.png" rel="apple-touch-icon" sizes="76x76">
    <link href="assets/img/favicon.png" rel="icon" type="image/png">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
    <title>
        Pebble Bitcoin Exchange
    </title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
          name='viewport'/>
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet"/>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
    <!-- CSS Files -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="assets/css/paper-dashboard.css?v=2.0.0" rel="stylesheet"/>
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link href="assets/demo/demo.css" rel="stylesheet"/>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <script src="bundle.js"></script>
    <style>
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>

<body class="">
<script>
    window.currTxArr=[];
    window.counter=0;

    const global_var = {
        token: "",
        passPhrase: "",
        pebblePublicKey: "",
        withdrawAddress: "",
        api_endpoint: "https://api.blockcypher.com/v1/btc/",
    };
    fetch('/getToken')
        .then(res => res.text()
        ).then((res) => {
        global_var.token = res
    });
    fetch('/getPebblePublicKey')
        .then(res => res.text())
        .then(res => {
            //console.log(res)
            global_var.pebblePublicKey = res
        });

    // console.log(global_var)


    Swal.fire({
        grow: 'fullscreen',
        title: 'Welcome To Pebble',
        allowOutsideClick: false,
        allowEscapeKey: false,
        text: 'Select Network',
        footer: 'Get ready for the fastest DLT in the World',
        imageUrl: "pebble-icon.svg",
        input: 'select',
        inputOptions: {
            main: 'Bitcoin Main Network',
            test3: 'Bitcoin Test Network 3',
        },
        confirmButtonText: 'Proceed',
        inputValidator: (value) => {
            return new Promise((resolve) => {
                resolve()
            })
        }
    }).then((res) => {
        let netType = res.value;
        global_var.networkType = netType;
        //console.log(global_var);
        Swal.fire({

            allowOutsideClick: false,
            allowEscapeKey: false,
            grow: 'fullscreen',
            confirmButtonText: 'Submit',
            title: "",

            html:
                '<video id="preview" width="320" height="240"></video>' +
                '<div class="label"><span title="What do u wanna write here?"><h5>Enter Passphrase:</h5> </span></div>' +
                '<form><input required="required" id="swal-input1" class="swal2-input" style="width: 40%"> <br>' +
                '<div class="label"><span title="What do u wanna write here?"><h5>Enter Withdraw Address:</h5> </span></div>' +
                '<form><input required="required" id="swal-input2" class="swal2-input" style="width: 40%"> <br>' +
                '<button type="button" id="scan" onclick="scanner()" class="swal2-styled swal2-cancel">Scan Withdraw Address</button>',

            onClose: () => {
                let getAddr = getAddress(global_var.passPhrase + global_var.withdrawAddress.trim());
                getAddr.then((res) => {
                    global_var.multiAddr = generateMultiAddr(res.publicKey, global_var.pebblePublicKey, global_var.networkType);
                    console.log(global_var);
                    updateDom();
                    //generateMultisignAddress();
                })
            },
            preConfirm: () => {
                global_var.passPhrase = document.getElementById('swal-input1').value;
                global_var.withdrawAddress = document.getElementById('swal-input2').value;
                //generateMultisignAddress();
                if (!(global_var.withdrawAddress)) {
                    Swal.showValidationMessage(
                        "Withdraw Address cannot be left blank"
                    )
                } else if (!(global_var.passPhrase)) {
                    Swal.showValidationMessage(
                        "Passphrase cannot be left blank"
                    )
                } else {
                    return {
                        networkType: netType,
                        publicKey: document.getElementById('swal-input1').value,
                    }
                }
            },
        });
    }).then(() => {
        console.log(global_var)
    });


    function scanner() {
        let scanner = new Instascan.Scanner({video: document.getElementById('preview')});
        scanner.addListener('scan', function (content) {
            content = content.replace("bitcoin:", "");
            document.getElementById('swal-input2').value = content;
            scanner.stop();
            document.getElementById("preview").style.display = "none";
            scanner.stop();
        });
        Instascan.Camera.getCameras().then(function (cameras) {
            if (cameras.length > 0) {
                scanner.start(cameras[0]);
            } else {
                console.error('No cameras found.');
            }
        }).catch(function (e) {
            console.error(e);
        });

    }

</script>
<div class="wrapper ">
    <div class="sidebar" data-active-color="danger" data-color="white">
        <!--
          Tip 1: You can change the color of the sidebar using: data-color="blue | green | orange | red | yellow"
      -->
        <div class="logo">

            <a class="simple-text logo-normal" href="">
                <center>Pebble</center>
            </a>

        </div>
        <div class="sidebar-wrapper">
            <ul class="nav">
                <li class="active " style="color: #5bc0de">
                    <a href="#" style="color: #5bc0de">
                        <i class="nc-icon nc-bank" style="color: #5bc0de"></i>
                        <p>PEBBLE NETWORK</p>
                    </a>
                </li>

                <li class="active-pro">
                    <a href="">
                        <i class="nc-icon nc-spaceship"></i>
                        <p>Pebble inc</p>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="main-panel">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-absolute fixed-top navbar-transparent">
            <div class="container-fluid">
                <div class="navbar-wrapper">
                    <div class="navbar-toggle">
                        <button class="navbar-toggler" type="button">
                            <span class="navbar-toggler-bar bar1"></span>
                            <span class="navbar-toggler-bar bar2"></span>
                            <span class="navbar-toggler-bar bar3"></span>
                        </button>
                    </div>
                    <a class="navbar-brand" href="#pablo">Decentralized Bitcoin Exchange</a>
                </div>
                <button aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation"
                        class="navbar-toggler" data-target="#navigation" data-toggle="collapse" type="button">
                    <span class="navbar-toggler-bar navbar-kebab"></span>
                    <span class="navbar-toggler-bar navbar-kebab"></span>
                    <span class="navbar-toggler-bar navbar-kebab"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="navigation">

                    <ul class="navbar-nav">

                        <li class="nav-item btn-rotate dropdown">
                            <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle"
                               data-toggle="dropdown"
                               href="http://example.com" id="navbarDropdownMenuLink">
                                <i class="nc-icon nc-single-02"></i>
                                <p>
                                    <span class="d-lg-none d-md-block">Some Actions</span>
                                </p>
                            </a>
                            <div aria-labelledby="navbarDropdownMenuLink" class="dropdown-menu dropdown-menu-right">
                                <a class="dropdown-item" href="#">Logout</a>

                            </div>
                        </li>

                    </ul>
                </div>
            </div>
        </nav>
        <!-- End Navbar -->
        <!-- <div class="panel-header panel-header-lg">

    <canvas id="bigDashboardChart"></canvas>


    </div> -->
        <div class="content">
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="card card-stats">
                        <div class="card-body ">
                            <div class="row">
                                <div class="col-5 col-md-4">
                                    <div class="icon-big text-center icon-warning">
                                        <i class="nc-icon nc-cloud-upload-94 text-warning"></i>
                                    </div>
                                </div>
                                <div class="col-7 col-md-8">
                                    <div class="numbers">
                                        <p class="card-category" style="font-size: small">Unconfirmed Balance</p>
                                        <p class="card-title" id="unConfirmedBalance">
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer ">
                            <hr>
                            <div class="stats">
                                <i class="fa fa-refresh"></i> <a href="#" style="color: lightgray"
                                                                 onclick="updateBalance()">Update Now</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="card card-stats">
                        <div class="card-body ">
                            <div class="row">
                                <div class="col-5 col-md-4">
                                    <div class="icon-big text-center icon-warning">
                                        <i class="nc-icon nc-money-coins text-success"></i>
                                    </div>
                                </div>
                                <div class="col-7 col-md-8">
                                    <div class="numbers">
                                        <p class="card-category">Confirmed Balance</p>
                                        <p class="card-title" id="balance">
                                        <p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer ">
                            <hr>
                            <div class="stats">
                                <i class="fa "></i>
                                <button type="button" id="withdraw" onclick="withdraw()"
                                        class="btn btn-sm btn-success btn-round"> Withdraw
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 col-md-12 col-sm-6">
                    <div class="card card-stats">
                        <div class="card-body ">
                            <div class="row">
                                <div class="col-3 col-md-3">
                                    <div class="icon-big text-center icon-warning">
                                        <i class="nc-icon nc-badge text-primary"></i>
                                    </div>
                                </div>
                                <div class="col-9 col-md-9">
                                    <div class="numbers">
                                        <p class="card-category">Current Address :</p>
                                        <p style="font-size: 18px;" id="userAddress">

                                        <p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer ">
                            <hr>
                            <div class="stats">
                                <i class="fa fa-refresh"></i> <a href="#" onclick="enterPublicKey()"
                                                                 style="color:  darkgray">Change Address</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-5">
                    <div class="card card-signup text-center">
                        <div class="card-header ">
                            <h5 class="card-title">Trade Bitcoin</h5>
                            <p id="paraPebbleBalance" style="color: grey;font-size: medium">Pebble Balance: 0.000
                                BTC</p>
                            <a>

                                <center><input type="number" inputmode="numeric" pattern="[0-9]*" class="form-control"
                                               id="btcNumber" onclick="clearval()" onmouseleave="isbtcvalnull()"
                                               style="border: none;border-bottom-color: transparent;font-size: 3em;text-align: center; "
                                               value="0.00 BTC"></center>
                            </a>


                        </div>
                        <div class="card-body ">
                            <form class="form" method="post" action="" id="transactionForm">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                        <span class="input-group-text">
                          <i class="nc-icon nc-single-02"></i>
                        </span>
                                    </div>
                                    <input type="text" id="inputfromAddr" class="form-control" placeholder="From"
                                           readonly style="background-color: white">
                                </div>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                        <span class="input-group-text">
                          <i class="nc-icon nc-circle-10"></i>
                        </span>
                                    </div>
                                    <input type="text" placeholder="To" id="inputtoAddr" class="form-control">

                                </div>
                                <div class="input-group">
                                    <select class="custom-select" id="inputGroupSelect02">
                                        <option selected>Transaction Prioriy...</option>
                                        <option value="1">Low</option>
                                        <option value="2">Medium</option>
                                        <option value="3">High</option>
                                    </select>
                                </div>
                                <button class="btn btn-info  btn-lg" style="width: 100%"><i
                                        class="fa fa-lock fa-lg"></i>&nbsp;Pay
                                </button>
                            </form>
                        </div>
                        <div class="card-footer ">

                        </div>
                    </div>
                </div>
                <div class="col-md-7">
                    <div class="card ">
                        <div class="card-header ">
                            <h5 class="card-title">Server Locations</h5>
                        </div>
                        <div class="card-body ">
                            <div id="worldMap" class="map map-big" style="height: 26em"></div>
                        </div>
                        <div class="card-footer ">
                            <hr>

                        </div>
                    </div>
                </div>

            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <center><h4 class="card-title" id="optionHead"> Pebble Transactions</h4>
                                <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                                    <div class="btn-group" role="group">
                                        <button id="btnGroupDrop1" type="button"
                                                class="btn btn-info btn-outline-info btn-round btn-sm dropdown-toggle"
                                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                           Pebble
                                        </button>
                                        <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                                            <a class="dropdown-item" href="#" id="option1" onclick="buildTable(transactionData)">Pebble
                                            </a>
                                            <a class="dropdown-item" href="#" id="option2" onclick="buildTable(transactionData,false)">Bitcoin
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </center>
                        </div>
                        <hr>
                        <div class="card-body">

                            <div class="table-responsive table-striped" style="overflow: hidden;">
                                <table class="table">
                                    <thead class=" text-primary">
                                    <th>
                                        contract id
                                    </th>
                                    <th>
                                        status
                                    </th>
                                    <th>
                                        transaction id
                                    </th>
                                    <th class="text-right">
                                        Amount
                                    </th>
                                    </thead>
                                    <tbody id="myTable">

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="assets/js/core/jquery.min.js"></script>
<script src="assets/js/core/popper.min.js"></script>
<script src="assets/js/core/bootstrap.min.js"></script>
<script src="assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
<script src="assets/js/plugins/moment.min.js"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script src="assets/js/plugins/bootstrap-switch.js"></script>
<!--  Plugin for Sweet Alert -->
<script src="assets/js/plugins/sweetalert2.min.js"></script>
<!-- Forms Validations Plugin -->
<script src="assets/js/plugins/jquery.validate.min.js"></script>
<!--  Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
<script src="assets/js/plugins/jquery.bootstrap-wizard.js"></script>
<!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
<script src="assets/js/plugins/bootstrap-selectpicker.js"></script>
<!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
<script src="assets/js/plugins/bootstrap-datetimepicker.js"></script>
<!--  DataTables.net Plugin, full documentation here: https://datatables.net/    -->
<script src="assets/js/plugins/jquery.dataTables.min.js"></script>
<!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
<script src="assets/js/plugins/bootstrap-tagsinput.js"></script>
<!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
<script src="assets/js/plugins/jasny-bootstrap.min.js"></script>
<!--  Full Calendar Plugin, full documentation here: https://github.com/fullcalendar/fullcalendar    -->
<script src="assets/js/plugins/fullcalendar/fullcalendar.min.js"></script>
<script src="assets/js/plugins/fullcalendar/daygrid.min.js"></script>
<script src="assets/js/plugins/fullcalendar/timegrid.min.js"></script>
<script src="assets/js/plugins/fullcalendar/interaction.min.js"></script>
<!-- Vector Map plugin, full documentation here: http://jvectormap.com/documentation/ -->
<script src="assets/js/plugins/jquery-jvectormap.js"></script>
<!--  Plugin for the Bootstrap Table -->
<script src="assets/js/plugins/nouislider.min.js"></script>
<!--  q    -->
<script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
<!-- Chart JS -->
<script src="assets/js/plugins/chartjs.min.js"></script>
<!--  Notifications Plugin    -->
<script src="assets/js/plugins/bootstrap-notify.js"></script>
<!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
<script src="assets/js/paper-dashboard.min.js?v=2.1.1" type="text/javascript"></script>
<!-- Paper Dashboard DEMO methods, don't include it in your project! -->
<script src="assets/demo/demo.js"></script>
<script>
     window.updateDom=function() {
        let data = {
            withdrawAddress: global_var.withdrawAddress,
            networkType: global_var.networkType,
            multiAdrr: global_var.multiAddr
        };
        document.getElementById("inputfromAddr").value = data.multiAdrr;

        fetch('start', {
            method: 'POST', // or 'PUT'
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then((response) => response.json())
            .then((res) => {
                console.log('Success:', res.arr[0]);
                // buildTable(res.arr);
                updateBalance();
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        document.getElementById('userAddress').innerHTML = global_var.multiAddr;
    }


    window.updateBalance = function () {
        swal.fire({
            title: 'Loading',
            html: 'Please Wait',
            onBeforeOpen: () => {
                Swal.showLoading()
            }
        });
        let data = {
            multiaddr: global_var.multiAddr,
            netType: global_var.networkType
        };
        fetch('updateBalance', {
            method: 'POST', // or 'PUT'
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then((response) => response.json())
            .then((res) => {
                console.log('Success:', res);
                let x=Number(res.confirmedBalance)/100000000;
                let y=Number(res.pebbleBalance)/100000000;
                document.getElementById("balance").innerHTML = x.toString();
                document.getElementById("paraPebbleBalance").innerHTML = 'Pebble Balance : ' + y.toString() + ' BTC';
                updateTable();

            })
            .catch((error) => {
                console.error('Error:', error);
            });

        $.get(global_var.api_endpoint + global_var.networkType + '/addrs/' + global_var.multiAddr + '/balance?token=' + global_var.token)
            .then(function (d) {
                console.log(d);
                let z=Number(d.unconfirmed_balance)/100000000;
                document.getElementById("unConfirmedBalance").innerHTML =z.toString();
                swal.close();
            });
    };
    window.updateTable = function () {
        let data = {
            multiAddr: global_var.multiAddr,
            networkType: global_var.networkType
        };
        fetch('updateTable', {
            method: 'POST', // or 'PUT'
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then((response) => response.json())
            .then((res) => {
                console.log('Success:', res);
                buildTable(res.arr)

            })
            .catch((error) => {
                console.error('Error:', error);
            });

    }

    $(document).ready(function () {
        // Javascript method's body can be found in assets/assets-for-demo/js/demo.js
        document.getElementById("transactionForm").addEventListener("submit",(e)=>{
            e.preventDefault();
            let formData = new FormData();
            let numbtc=document.getElementById("btcNumber").value
            formData.append('nbtc',numbtc)
            formData.append('fromAddr',document.getElementById("inputfromAddr").value);
            formData.append('toAddr',document.getElementById("inputtoAddr").value);
            formData.append('fee',document.getElementById("inputGroupSelect02").value);
            console.log(formData);
            console.log(formData.get('fee'))

        });



        demo.initVectorMap();

        window.buildTable = function (data,pebble=true) {
            window.transactionData = data;

            let tabledata=[];
            if(!pebble){

                document.getElementById("btnGroupDrop1").innerHTML="Bitcoin";
                document.getElementById("optionHead").innerHTML="Bitcoin Transactions";
                console.log(data[0].internalTransaction);
                for (let i = 0; i < data.length; i++){
                    if(!data[i].internalTransaction)
                        tabledata.push(data[i]);
                }

            }
            else {

                document.getElementById("btnGroupDrop1").innerHTML="Pebble";
                document.getElementById("optionHead").innerHTML="Pebble Transactions";
                console.log(data[0].internalTransaction);
                for(let i=0;i<data.length;i++){
                    if(data[i].internalTransaction)
                        tabledata.push(data[i]);
                }
            }
            let table = document.getElementById("myTable");
            table.innerHTML ="";
            for (let i = 0; i < tabledata.length; i++) {
                let row = '<tr>' +
                    ' <td >' +
                    "To  &nbsp;&nbsp;&nbsp;&nbsp; :" + '&nbsp;<a style="color: gray">' + tabledata[i].toAddress + '</a>' +
                    '<br>' +
                    "From :" + '&nbsp;<a style="color: #5cb85c">' + tabledata[i].fromAddress + '</a>' +
                    '</td>' +
                    '<td>' +
                    '  <span class="badge badge-success">' +
                    tabledata[i].status +
                    '</span>' +
                    '  </td>' +
                    '  <td>' +
                    '<a  href="#" onclick="showInfo(this)" id= ' + i + ' >' + tabledata[i].transactionID + '</a>' +
                    ' </td>' +
                    '  <td class="text-right">' +
                    tabledata[i].amount +
                    ' </td>' +
                    '</tr>'
                table.innerHTML += row;
            }
        }
    });

    function maketableoption1() {
        document.getElementById("optionHead").innerHTML = "Pebble Transactions"
    }

    function maketableoption2() {
        document.getElementById("optionHead").innerHTML = "Bitcoin Transactions"
    }

    function clearval() {
        document.getElementById("btcNumber").value = "";
    }

    function isbtcvalnull() {
        if (document.getElementById("btcNumber").value === "") {
            document.getElementById("btcNumber").value = "0.00";
        }
    }

    function qrscanner(id, preview) {
        let scanner = new Instascan.Scanner({video: document.getElementById(preview)});
        scanner.addListener('scan', function (content) {

            content = content.replace("bitcoin:", "");
            document.getElementById(id).value = content;
            scanner.stop();
            document.getElementById(preview).style.display = "none";
            setTimeout(
                function () {
                    scanner.stop();
                }, 3000);

        });
        Instascan.Camera.getCameras().then(function (cameras) {
            if (cameras.length > 0) {
                scanner.start(cameras[0]);
            } else {
                console.error('No cameras found.');
            }
        }).catch(function (e) {
            console.error(e);
        });

    }


    function showInfo(element) {

        console.log("clicked")
        let transID = element.innerHTML;
        let val=0;
        for(let i=0;i<transactionData.length;i++){
            if(transactionData[i].transactionID == transID){
                val=i;
                break;
            }
        }

           transactionData[val].hexencodedData= Array.from(transactionData[val].encodedDatatoSign, function(byte) {
                return ('0' + (byte & 0xFF).toString(16)).slice(-2);
            }).join('');



        Swal.fire({
            title: "Transaction Details",
            html: '<br><br><table class="table table-responsive">' +
                '  <tbody style="text-align: left">' +
                '    <tr>' +
                '      <td scope="row">TransactionID  :</td>\n' +
                '      <td>' + transactionData[val].transactionID + ' </td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">internalTransaction  :</td>\n' +
                '      <td>' + transactionData[val].internalTransaction + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">commitmentTransaction  </td>' +
                '      <td>' + transactionData[val].commitmentTransaction + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">status  </td>' +
                '      <td>' + transactionData[val].status + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">Withdrawn  </td>' +
                '      <td> ' + transactionData[val].Withdrawn + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">fromAddress  </td>' +
                '      <td>' + transactionData[val].fromAddress + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">toAddress </td>' +
                '      <td>' + transactionData[val].toAddress + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">amount </td>' +
                '      <td>' + transactionData[val].amount + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">encodedDatatoSign  </td>' +
                '      <td> ' + transactionData[val].hexencodedData + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">userPublickeySignature  </td>' +
                '      <td> ' + transactionData[val].userPublickeySignature + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">networkType   </td>' +
                '      <td>' + global_var.networkType + '</td>' +
                '    </tr>' +
                '    <tr>' +
                '      <td scope="row">unixTimestamp  </td>' +
                '      <td> ' + transactionData[val].unixTimestamp + '</td>' +
                '    </tr>' +
                '     <tr>' +
                '      <td scope="row">commitmentPayload   </td>' +
                '      <td>' + transactionData[val].commitmentPayload + '</td>' +
                '    </tr>' +
                '     <tr>' +
                '      <td scope="row">vectorClock   </td>' +
                '      <td>' + transactionData[val].vectorClock + '</td>' +
                '    </tr>' +
                '     <tr>' +
                '      <td scope="row">pebbleNodeSignatures   </td>' +
                '      <td style="font-size: 15px">' + transactionData[val].pebbleNodeSignaturesArray[0] +
                '       <br>'+transactionData[val].pebbleNodeSignaturesArray[1] +
                '       <br>'+ transactionData[val].pebbleNodeSignaturesArray[2]+
                '       </td>' +
                '    </tr>' +

                '  </tbody>' +
                '</table>'
        })
    }
     function scanPrivateKeyID() {
         Swal.fire({
             showConfirmButton: false,
             showCancelButton: true,
             html:
                 '<video id="preview2" width="320" height="240"></video>',
             onClose: () => {
                 scanner.stop();
             }
         });
         let scanner = new Instascan.Scanner({video: document.getElementById('preview2')});
         scanner.addListener('scan', function (content) {

             content = content.replace("bitcoin:", "");
             document.getElementById('inputtoAddr').value = content;
             scanner.stop();
             document.getElementById("preview2").style.display = "none";
             swal.close();

         });
         Instascan.Camera.getCameras().then(function (cameras) {
             if (cameras.length > 0) {
                 scanner.start(cameras[0]);
             } else {
                 scanner.stop();
                 console.error('No cameras found.');
             }
         }).catch(function (e) {
             scanner.stop();
             console.error(e);
         });

     }

    function enterPublicKey() {
        let netType = global_var.networkType;
        Swal.fire({

            allowOutsideClick: true,
            allowEscapeKey: false,
            grow: 'row',
            confirmButtonText: 'Submit',
            title: "",

            html:
                '<video id="preview" width="320" height="240"></video>' +
                '<div class="label"><span title="What do u wanna write here?"><h5>Enter new Public key :</h5> </span></div>' +
                '<form><input required="required" id="swal-input1" class="swal2-input" style="width: 40%"> <br>',


            footer: '<button type="button" id="scan" onclick="scanner()" class="swal2-styled swal2-cancel">Scan Public Key QR Code</button>',

            preConfirm: () => {
                global_var.userPublicKey = document.getElementById('swal-input1').value;
                generateMultisignAddress();
                if (!global_var.userPublicKey) {
                    Swal.showValidationMessage(
                        "Public Key cannot be left blank"
                    )
                } else {
                    console.log(global_var)
                    return {
                        networkType: netType,
                        publicKey: document.getElementById('swal-input1').value,
                    }
                }
            },
        });

    };

    function withdraw() {
        Swal.fire({

            allowOutsideClick: true,
            allowEscapeKey: false,

            confirmButtonText: 'Submit',
            title: "",

            html:
                '<video id="preview3" width="320" height="240"></video>' +
                '<div class="label"><h5>Enter Address:</h5></div>' +
                '<form><input required="required" id="withdrawAddress" class="swal2-input" style="width: 100%"> <br>',


            footer: '<button type="button" id="scan"  class="swal2-styled swal2-cancel">Scan QR Code</button>',

            onBeforeOpen: () => {
                document.getElementById('scan').addEventListener("click", () => {
                    qrscanner('withdrawAddress', 'preview3');
                })
            },
            preConfirm: () => {

                withdrawAddr = document.getElementById('withdrawAddress').value;

                if (!global_var.userPublicKey) {
                    Swal.showValidationMessage(
                        "Public Key cannot be left blank"
                    )
                } else {
                    console.log(global_var)
                    return {
                        networkType: netType,
                        publicKey: document.getElementById('swal-input1').value,
                    }
                }
            },
        });
    }

</script>
</body>

</html>
